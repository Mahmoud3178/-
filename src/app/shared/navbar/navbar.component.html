<ng-container *ngIf="ready">
  <header dir="rtl" class="bg-light shadow-sm">
<!-- ✅ Top bar -->
<div class="bg-primary-subtle py-2">
  <div class="w-90-custom d-flex justify-content-between align-items-center mx-auto">
    <ng-container *ngIf="(userData$ | async) as user">
      <ng-container *ngIf="!(isLoggedIn$ | async) || user.role !== 'provider'; else placeholder">
        <a routerLink="/dashboard" class="btn-outline-primary btn-sm d-flex align-items-center gap-1 fw-bold">
        </a>
      </ng-container>
      <ng-template #placeholder>
        <div style="width: 130px;"></div>
      </ng-template>

      <!-- ✅ Developed by Qadara -->
      <div class="d-flex align-items-center gap-3">
        <p class="fw-bold m-0" style="font-size: 1rem; color: #0d6efd;">
          Developed by
          <a href="https://www.linkedin.com/company/qadara/" target="_blank"
             class="text-decoration-none fw-bold" style="color: #0d6efd;">
            Qadara | قُدْرَة
          </a>
        </p>
      </div>
    </ng-container>
  </div>
</div>



    <!-- ✅ Main Navbar -->
    <nav class="navbar navbar-expand-lg py-3">
      <div class="w-90-custom mx-auto position-relative d-flex align-items-center justify-content-between">
<!-- ✅ جرس الإشعارات -->
<ng-container *ngIf="(userData$ | async)?.role === 'provider'">
  <div class="position-absolute bell-left">
    <a routerLink="/provider-notifications" class="btn btn-outline-secondary position-relative">
      <i class="bi bi-bell fs-5"></i>

      <!-- ✅ البادج المحسن -->
      <span *ngIf="notificationCount > 0"
            class="position-absolute top-0 start-100 translate-middle badge rounded-circle bg-danger d-flex align-items-center justify-content-center"
            style="min-width: 22px; height: 22px; font-size: 0.75rem;">
        {{ notificationCount }}
      </span>
    </a>
  </div>
</ng-container>


        <!-- ✅ اللوجو -->
        <a class="navbar-brand" [routerLink]="(userData$ | async)?.role === 'provider' ? '/provider-home' : '/hero'">
          <img src="images/FB_IMG_1754589930346.png" alt="logo" style="height: 60px; max-width: 60px; border-radius: 50%;">
        </a>

        <!-- ✅ زر القائمة (يظهر فقط في الشاشات الصغيرة) -->
        <button class="menu-btn d-lg-none" (click)="showMobileMenu = true">
          <i class="bi bi-list fs-3 text-dark"></i>
        </button>

        <!-- ✅ المحتوى القابل للطي -->
        <div [ngClass]="{'collapse': isNavbarCollapsed, 'navbar-collapse': true}" class="justify-content-between mt-3 mt-lg-0" id="mainNavbar">
          <!-- ✅ روابط المستخدم العادي -->
          <ul *ngIf="(userData$ | async)?.role !== 'provider'" class="navbar-nav mb-2 mb-lg-0 flex-grow-1 justify-content-center">
            <li class="nav-item px-2"><a class="nav-link" href="#hero">الرئيسية</a></li>
            <li class="nav-item px-2"><a class="nav-link" href="#offers">العروض</a></li>
            <li class="nav-item px-2"><a class="nav-link" href="#features">مميزاتنا</a></li>
            <li class="nav-item px-2"><a class="nav-link" href="#srvices">الخدمات</a></li>
            <li class="nav-item px-2"><a class="nav-link" routerLink="/call-us">اتصل بنا</a></li>
            <li class="nav-item px-2" *ngIf="!(isLoggedIn$ | async)">
              <a class="nav-link" routerLink="/login">انضم إلينا</a>
            </li>
          </ul>

          <!-- ✅ أزرار التسجيل والدخول أو روابط العميل -->
          <div class="d-flex align-items-center gap-4" *ngIf="(userData$ | async)?.role !== 'provider'">
            <ng-container *ngIf="!(isLoggedIn$ | async); else clientLinks">
              <button routerLink="/register" class="btn btn-primary fw-bold px-5 py-1">إنشاء حساب</button>
              <button routerLink="/login" class="btn btn-outline-warning fw-bold px-5 py-1">تسجيل الدخول</button>
            </ng-container>

 <ng-template #clientLinks>
  <!-- رابط الطلبات -->
  <a routerLink="/order" class="text-center d-flex flex-column align-items-center text-decoration-none">
    <i class="bi bi-basket fs-5 text-primary"></i>
    <small class="text-dark">الطلبات</small>
  </a>

<a routerLink="/notifications" class="text-center d-flex flex-column align-items-center text-decoration-none">
  <span class="position-relative d-inline-flex align-items-center justify-content-center">
    <i class="bi bi-bell fs-5 text-primary"></i>
    <span *ngIf="notificationCount > 0"
          class="position-absolute top-0 start-50 translate-middle badge rounded-pill bg-danger px-2"
          style="
            font-size: 0.7rem;
            min-width: 18px;
            text-align: center;
            transform: translate(-30%, -50%);
          ">
      {{ notificationCount }}
    </span>
  </span>
  <small class="text-dark">الإشعارات</small>
</a>

  <!-- رابط البروفايل -->
  <ng-container *ngIf="(userData$ | async) as user">
    <div routerLink="/profile" class="text-center d-flex flex-column align-items-center">
      <img
        [src]="user.image"
        (error)="user.image = 'assets/images/default-avatar.png'"
        alt="User"
        class="rounded-circle"
        style="width: 36px; height: 36px;"
      />
      <small>{{ user.name }}</small>
    </div>
  </ng-container>
</ng-template>

          </div>
        </div>
      </div>
    </nav>
  </header>

  <!-- ✅ قائمة الموبايل فقط -->
  <div
    class="mobile-menu d-lg-none"
    *ngIf="showMobileMenu && (userData$ | async) as user"
    [hidden]="user.role === 'provider'"
  >
    <div class="mobile-menu-header d-flex justify-content-between align-items-center">
      <button class="btn-close-menu" (click)="showMobileMenu = false">
        <i class="bi bi-x-lg fs-4 text-white"></i>
      </button>
      <img src="images/FB_IMG_1754589930346.png" alt="logo" style="height: 50px; height: 60px; border-radius: 50%;" />
    </div>

    <ul class="mobile-nav mt-4">
      <li><a href="#hero">الرئيسية</a></li>
      <li><a href="#offers">العروض</a></li>
      <li><a href="#features">مميزاتنا</a></li>
      <li><a href="#srvices">الخدمات</a></li>
      <li><a routerLink="/call-us">اتصل بنا</a></li>

      <!-- ✅ فقط لو مش مسجل دخول -->
      <li *ngIf="!(isLoggedIn$ | async)">
        <a routerLink="/login">انضم إلينا</a>
      </li>

      <!-- ✅ روابط العميل -->
      <ng-container *ngIf="user.role === 'client'">
        <li><a routerLink="/order">الطلبات</a></li>
        <li><a routerLink="/notifications">الإشعارات</a></li>
        <li><a routerLink="/profile">الملف الشخصي</a></li>
      </ng-container>

      <!-- ✅ روابط مقدم الخدمة -->
      <ng-container *ngIf="user.role === 'provider'">
        <li><a routerLink="/provider-home">لوحة التحكم</a></li>
        <li><a routerLink="/provider-notifications">الإشعارات</a></li>
      </ng-container>
    </ul>

    <!-- ✅ أزرار التسجيل فقط لغير المسجلين -->
    <div class="mobile-actions mt-4" *ngIf="!(isLoggedIn$ | async)">
      <button routerLink="/register" class="btn btn-primary w-100 mb-2">إنشاء حساب</button>
      <button routerLink="/login" class="btn btn-outline-warning w-100">تسجيل الدخول</button>
    </div>
  </div>
</ng-container>
